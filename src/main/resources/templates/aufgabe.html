<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${exercise.title}"></title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
    <div class="nav-container">
        <a th:href="@{/lesson/{id}(id=${exercise.lesson.id})}" class="nav-back">
            <i class="fas fa-arrow-left"></i> Zurück zur Lektion
        </a>
        <div class="nav-brand">
            <i class="fas fa-code"></i>
            <span>Proginator</span>
        </div>
    </div>
</nav>

<!-- Main Content -->
<div class="container exercise-container">
    <!-- Exercise Header -->
    <div class="exercise-header">
        <div class="exercise-badges">
            <span class="badge badge-lesson">
                Woche <span th:text="${exercise.lesson.id}"></span>
            </span>
            <span class="badge badge-easy" th:if="${exercise.difficulty} == 'EASY'">
                <i class="fas fa-star"></i>
                <span th:text="${exercise.difficulty}"></span>
            </span>
            <span class="badge badge-medium" th:if="${exercise.difficulty} == 'MEDIUM'">
                <i class="fas fa-star-half-alt"></i>
                <span th:text="${exercise.difficulty}"></span>
            </span>
            <span class="badge badge-hard" th:if="${exercise.difficulty} == 'HARD'">
                <i class="fas fa-star"></i>
                <span th:text="${exercise.difficulty}"></span>
            </span>
            <span class="badge badge-points">
                <i class="fas fa-coins"></i>
                <span th:text="${exercise.points} + ' Punkte'"></span>
            </span>
        </div>

        <h1 th:text="${exercise.title}"></h1>

        <div class="completion-status" th:if="${completed}">
            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i>
                Diese Aufgabe hast du bereits abgeschlossen!
            </div>
        </div>
    </div>

    <!-- Task Description -->
    <div class="task-section">
        <h2><i class="fas fa-question-circle"></i> Aufgabenstellung</h2>
        <div class="task-card">
            <div th:utext="${exercise.description}"></div>
        </div>
    </div>

    <!-- Starter Code -->
    <div class="code-section">
        <h2><i class="fas fa-code"></i> Starter-Code</h2>
        <pre><code class="language-java" th:text="${exercise.starterCode}"></code></pre>
    </div>

    <!-- Solution (Collapsible) -->
    <div class="solution-section">
        <details>
            <summary><i class="fas fa-lightbulb"></i> Lösung anzeigen</summary>
            <pre><code class="language-java" th:text="${exercise.solution}"></code></pre>
        </details>
    </div>

    <!-- Actions -->
    <div class="actions-section">
        <form th:action="@{/exercise/{id}/complete(id=${exercise.id})}" method="post" th:if="!${completed}">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-check"></i> Aufgabe als erledigt markieren
            </button>
        </form>
        <a th:if="${nextExercise != null}" th:href="@{/exercise/{id}(id=${nextExercise})}" class="btn btn-primary">
            <i class="fas fa-arrow-right"></i> Nächste Aufgabe
        </a>
    </div>
</div>

<script src="/js/main.js"></script>
</body>
</html>